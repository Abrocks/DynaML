<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>DynaML by mandar2812</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">DynaML</h1>
      <h2 class="project-tagline">Scala Library/REPL for scalable Machine Learning</h2>
      <a href="https://github.com/mandar2812/DynaML" class="btn">View on GitHub</a>
      <a href="https://github.com/mandar2812/DynaML/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mandar2812/DynaML/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="dynaml" class="anchor" href="#dynaml" aria-hidden="true"><span class="octicon octicon-link"></span></a>DynaML</h1>

<p><a href="https://travis-ci.org/mandar2812/DynaML"><img src="https://travis-ci.org/mandar2812/DynaML.svg?branch=branch-1.0" alt="Build Status"></a></p>

<h1>
<a id="aim" class="anchor" href="#aim" aria-hidden="true"><span class="octicon octicon-link"></span></a>Aim</h1>

<p>DynaML is a scala library/repl for implementing and working with general Machine Learning models. Machine Learning/AI applications make heavy use of various entities such as graphs, vectors, matrices etc as well as classes of mathematical models which deal with broadly three kinds of tasks, prediction, classification and clustering.</p>

<p>The aim is to build a robust set of abstract classes and interfaces, which can be extended easily to implement advanced models for small and large scale applications.</p>

<p>But the library can also be used as an educational/research tool for multi scale data analysis. </p>

<p>Currently DynaML has implementations of Least Squares Support Vector Machine (LS-SVM) for binary classification and regression. LS-SVM is equivalent to ridge regression/Tikhonov regularization, for further background consider <a href="https://en.wikipedia.org/wiki/Least_squares_support_vector_machine">Wikipedia</a> or the <a href="http://www.amazon.com/Least-Squares-Support-Vector-Machines/dp/9812381511">book</a>.   </p>

<p>A good general introduction to Probabilistic Models for Machine Learning can be found <a href="http://web4.cs.ucl.ac.uk/staff/D.Barber/textbook/131214.pdf">here</a> in <a href="http://web4.cs.ucl.ac.uk/staff/D.Barber/pmwiki/pmwiki.php?n=Brml.HomePage">David Barber's</a> text book. The LS-SVM is equivalent to the class of models discussed in Chapter 18 (Bayesian Linear Models) of the book.</p>

<h1>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Prerequisites: Maven</p>

<ul>
<li>Clone this repository</li>
<li>Run the following.</li>
</ul>

<div class="highlight highlight-shell"><pre>  mvn clean compile
  mvn package</pre></div>

<ul>
<li>Make sure you give execution permission to <code>bayeslearn-repl</code> in the <code>target/bin</code> directory.</li>
</ul>

<div class="highlight highlight-shell"><pre>  chmod +x target/bin/bayesLearn-repl
  target/bin/bayesLearn-repl</pre></div>

<p>You should get the following prompt.</p>

<pre><code>    ___       ___       ___       ___       ___       ___   
   /\  \     /\__\     /\__\     /\  \     /\__\     /\__\  
  /::\  \   |::L__L   /:| _|_   /::\  \   /::L_L_   /:/  /  
 /:/\:\__\  |:::\__\ /::|/\__\ /::\:\__\ /:/L:\__\ /:/__/   
 \:\/:/  /  /:;;/__/ \/|::/  / \/\::/  / \/_/:/  / \:\  \   
  \::/  /   \/__/      |:/  /    /:/  /    /:/  /   \:\__\  
   \/__/               \/__/     \/__/     \/__/     \/__/  

Welcome to DynaML v 1.2
Interactive Scala shell
STADIUS ESAT KU Leuven (2015)

DynaML&gt;
</code></pre>

<h1>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h1>

<p>The <code>data/</code> directory contains a few sample data sets, and the root directory also has example scripts which can be executed in the shell.</p>

<ul>
<li>First we create a linear classification model on a csv data set. We will assume that the last column in each line of the file is the target value, and we build an LS-SVM model.</li>
</ul>

<div class="highlight highlight-scala"><pre>    <span class="pl-k">val</span> <span class="pl-en">config</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>data/ripley.csv<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>delim<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>,<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>head<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>false<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>task<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>classification<span class="pl-pds">"</span></span>)
    <span class="pl-k">val</span> <span class="pl-en">model</span> <span class="pl-k">=</span> <span class="pl-en">GaussianLinearModel</span>(config)</pre></div>

<ul>
<li>We can now (optionally) add a Kernel on the model to create a generalized linear Bayesian model.</li>
</ul>

<div class="highlight highlight-scala"><pre>  <span class="pl-k">val</span> <span class="pl-en">rbf</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">RBFKernel</span>(<span class="pl-c1">1.025</span>)
  model.applyKernel(rbf)</pre></div>

<pre><code>15/06/25 22:30:57 INFO SVMKernel$: Constructing key-value representation of kernel matrix.
15/06/25 22:30:57 INFO SVMKernel$: Dimension: 13 x 13
15/06/25 22:30:57 INFO SVMKernelMatrix: Eigenvalue decomposition of the kernel matrix using JBlas.
15/06/25 22:30:57 INFO SVMKernelMatrix: Eigenvalue stats: 0.09797818213131776 =&lt; lambda =&lt; 3.178218421049352
15/06/25 22:30:57 INFO GaussianLinearModel: Applying Feature map to data set
15/06/25 22:30:57 INFO GaussianLinearModel: DONE: Applying Feature map to data set
bayeslearn&gt;
</code></pre>

<ul>
<li>Now we can solve the optimization problem posed by the LS-SVM in the parameter space. Since the LS-SVM problem is equivalent to ridge regression, we have to specify a regularization constant.</li>
</ul>

<div class="highlight highlight-scala"><pre>  model.setRegParam(<span class="pl-c1">1.5</span>).learn</pre></div>

<ul>
<li><p>We can now predict the value of the target variable given a new point consisting of a Vector of features using <code>model.predict()</code>.</p></li>
<li><p>Evaluating models is easy in DynaML. You can create an evaluation object as follows. </p></li>
</ul>

<div class="highlight highlight-scala"><pre>    <span class="pl-k">val</span> <span class="pl-en">configtest</span> <span class="pl-k">=</span> <span class="pl-en">Map</span>(<span class="pl-s"><span class="pl-pds">"</span>file<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>data/ripleytest.csv<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>delim<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>,<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>head<span class="pl-pds">"</span></span> <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>false<span class="pl-pds">"</span></span>)
    <span class="pl-k">val</span> <span class="pl-en">met</span> <span class="pl-k">=</span> model.evaluate(configtest)
    met.print</pre></div>

<ul>
<li>The object <code>met</code> has a <code>print()</code> method which will dump some performance metrics in the shell. But you can also generate plots by using the <code>generatePlots()</code> method.</li>
</ul>

<pre><code>15/06/25 22:35:06 INFO BinaryClassificationMetrics: Classification Model Performance
15/06/25 22:35:06 INFO BinaryClassificationMetrics: ============================
15/06/25 22:35:06 INFO BinaryClassificationMetrics: Area under PR: NaN
15/06/25 22:35:06 INFO BinaryClassificationMetrics: Area under ROC: 0.8160130718954248
</code></pre>

<div class="highlight highlight-scala"><pre>met.generatePlots</pre></div>

<p><img src="https://lh3.googleusercontent.com/_5_3y0lkD2lDETqw8RHfUzdFJOO4CLn4jreI5iaWu51vyERoy4F5VzROzhZJM2sYnDPh3VuYAZBKNOM=w1291-h561-rw" alt="Image of Plots"></p>

<ul>
<li><p>Although kernel based models allow great flexibility in modeling non linear behavior in data, they are highly sensitive to the values of their hyper-parameters. For example if we use a Radial Basis Function (RBF) Kernel, it is a non trivial problem to find the best values of the kernel bandwidth and the regularization constant.</p></li>
<li><p>In order to find the best hyper-parameters for a general kernel based supervised learning model, we use methods in gradient free global optimization. This is relevant because the cost (objective) function for the hyper-parameters is not smooth in general. In fact in most common scenarios the objective function is defined in terms of some kind of cross validation performance.</p></li>
<li><p>DynaML has a robust global optimization API, currently Coupled Simulated Annealing and Grid Search algorithms are implemented, the API in the package <code>org.kuleven.esat.optimization</code> can be extended to implement any general gradient or gradient free optimization methods.</p></li>
<li><p>Lets tune an RBF kernel on the Ripley data.</p></li>
</ul>

<div class="highlight highlight-scala"><pre><span class="pl-k">import</span> <span class="pl-v">com.tinkerpop.blueprints.</span><span class="pl-v">Graph</span>
<span class="pl-k">import</span> <span class="pl-v">com.tinkerpop.frames.</span><span class="pl-v">FramedGraph</span>
<span class="pl-k">import</span> <span class="pl-v">io.github.mandar2812.dynaml.graphUtils.</span><span class="pl-v">CausalEdge</span>
<span class="pl-k">val</span> (optModel, optConfig) <span class="pl-k">=</span> <span class="pl-en">KernelizedModel</span>.getOptimizedModel[<span class="pl-en">FramedGraph</span>[<span class="pl-en">Graph</span>],
      <span class="pl-en">Iterable</span>[<span class="pl-en">CausalEdge</span>], model.type](model, <span class="pl-s"><span class="pl-pds">"</span>csa<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>RBF<span class="pl-pds">"</span></span>, <span class="pl-c1">13</span>, <span class="pl-c1">7</span>, <span class="pl-c1">0.3</span>, <span class="pl-c1">true</span>)</pre></div>

<p>We see a long list of logs which end in something like the snippet below, the Coupled Simulated Annealing model, gives us a set of hyper-parameters and their values. </p>

<pre><code>optModel: io.github.mandar2812.dynaml.models.GaussianLinearModel = io.github.mandar2812.dynaml.models.GaussianLinearModel@6adcc6d9
optConfig: scala.collection.immutable.Map[String,Double] = Map(bandwidth -&gt; 4.292522306297284, RegParam -&gt; 7.56099893666852)
</code></pre>

<p>To inspect the performance of this kernel model on an independent test set, we can use the <code>model.evaluate()</code> function. But before that we must train this 'optimized' kernel model on the training set.</p>

<div class="highlight highlight-scala"><pre>optModel.setMaxIterations(<span class="pl-c1">2</span>).learn()
<span class="pl-k">val</span> <span class="pl-en">met</span> <span class="pl-k">=</span> optModel.evaluate(configtest)
met.print()
met.generatePlots()</pre></div>

<p>And the evaluation results follow ...</p>

<pre><code>15/06/25 23:49:32 INFO BinaryClassificationMetrics: Classification Model Performance
15/06/25 23:49:32 INFO BinaryClassificationMetrics: ============================
15/06/25 23:49:32 INFO BinaryClassificationMetrics: Area under PR: NaN
15/06/25 23:49:32 INFO BinaryClassificationMetrics: Area under ROC: 0.8696078431372549
</code></pre>

<h1>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Documentation</h1>

<p>You can refer to the project <a href="http://mandar2812.github.io/DynaML/">home page</a> or the <a href="http://mandar2812.github.io/DynaML/target/site/scaladocs/index.html#package">documentation</a> for getting started with DynaML. Bear in mind that this is still at its infancy and there will be many more improvements/tweaks in the future.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mandar2812/DynaML">DynaML</a> is maintained by <a href="https://github.com/mandar2812">mandar2812</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-59996358-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>

